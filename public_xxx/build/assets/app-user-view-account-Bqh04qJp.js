document.addEventListener("DOMContentLoaded",function(v){const u=document.querySelector(".datatable-project"),b=document.querySelector(".datatable-invoice");if(u){let l=document.createElement("h5");l.classList.add("card-title","mb-0","text-md-start","text-center"),l.innerHTML="Project List";var f=new DataTable(u,{ajax:assetsPath+"json/projects-list.json",columns:[{data:"hours"},{data:"project_name"},{data:"total_task"},{data:"progress"},{data:"hours"}],columnDefs:[{className:"control",searchable:!1,orderable:!1,responsivePriority:2,targets:0,render:function(o,i,n,t){return""}},{targets:1,responsivePriority:1,render:function(o,i,n,t){var e=n.project_name,a=n.framework,s=n.project_image,r="";if(s)r='<img src="'+assetsPath+"img/icons/brands/"+s+'" alt="Project Image" class="rounded-circle">';else{var c=Math.floor(Math.random()*6)+1,d=["success","danger","warning","info","dark","primary","secondary"],p=d[c],e=n.full_name,m=e.match(/\b\w/g)||[];m=((m.shift()||"")+(m.pop()||"")).toUpperCase(),r='<span class="avatar-initial rounded-circle bg-label-'+p+'">'+m+"</span>"}var g='<div class="d-flex justify-content-left align-items-center"><div class="avatar-wrapper"><div class="avatar avatar-sm me-3">'+r+'</div></div><div class="d-flex flex-column"><span class="text-truncate fw-medium text-heading">'+e+"</span><small>"+a+"</small></div></div>";return g}},{targets:2,render:function(o,i,n,t){var e=n.total_task;return`<span class="text-heading">${e}</span>`}},{targets:3,responsivePriority:3,render:function(o,i,n,t){var e=n.progress+"%",a,s;switch(!0){case n.progress<25:a="bg-danger",s="bg-label-danger";break;case n.progress<50:a="bg-warning",s="bg-label-warning";break;case n.progress<75:a="bg-info",s="bg-label-info";break;case n.progress<=100:a="bg-success",s="bg-label-success";break}return'<div class="d-flex flex-column"><p class="mb-0 text-heading">'+e+'</p><div class="progress rounded '+s+' w-100 me-3" style="height: 6px;"><div class="progress-bar rounded '+a+'" style="width: '+e+'" aria-valuenow="'+e+'" aria-valuemin="0" aria-valuemax="100"></div></div></div>'}},{targets:4,orderable:!1}],order:[[1,"desc"]],layout:{topStart:{rowClass:"row mx-md-2 my-0 justify-content-between",features:[l]},topEnd:{search:{placeholder:"Search Project",text:"_INPUT_"}},bottomStart:{},bottomEnd:{}},displayLength:7,language:{paginate:{next:'<i class="icon-base ri ri-arrow-right-s-line scaleX-n1-rtl icon-22px"></i>',previous:'<i class="icon-base ri ri-arrow-left-s-line scaleX-n1-rtl icon-22px"></i>',first:'<i class="icon-base ri ri-skip-back-mini-line scaleX-n1-rtl icon-22px"></i>',last:'<i class="icon-base ri ri-skip-forward-mini-line scaleX-n1-rtl icon-22px"></i>'}},responsive:{details:{display:DataTable.Responsive.display.modal({header:function(o){return"Details of "+o.data().project_name}}),type:"column",renderer:function(o,i,n){const t=n.map(function(e){return e.title!==""?`<tr data-dt-row="${e.rowIndex}" data-dt-column="${e.columnIndex}">
                      <td>${e.title}:</td>
                      <td>${e.data}</td>
                    </tr>`:""}).join("");if(t){const e=document.createElement("div");e.classList.add("table-responsive");const a=document.createElement("table");e.appendChild(a),a.classList.add("table");const s=document.createElement("tbody");return s.innerHTML=t,a.appendChild(s),e}return!1}}}});document.addEventListener("click",function(o){if(o.target.classList.contains("delete-record")){f.row(o.target.closest("tr")).remove().draw();const i=document.querySelector(".dtr-bs-modal");if(i&&i.classList.contains("show")){const n=bootstrap.Modal.getInstance(i);n==null||n.hide()}}})}if(b){let i=function(t){let e=document.querySelector(".dtr-expanded");t&&(e=t.target.parentElement.closest("tr")),e&&o.row(e).remove().draw()},n=function(){const t=document.querySelector(".datatable-invoice"),e=document.querySelector(".dtr-bs-modal");if(t&&t.classList.contains("collapsed"))e&&e.addEventListener("click",function(a){if(a.target.parentElement.classList.contains("delete-record")){i();const s=e.querySelector(".btn-close");s&&s.click()}});else{const a=t==null?void 0:t.querySelector("tbody");a&&a.addEventListener("click",function(s){s.target.parentElement.classList.contains("delete-record")&&i(s)})}};var x=i,w=n;let l=document.createElement("h5");l.classList.add("card-title","mb-0","text-md-start","text-center"),l.innerHTML="Invoice List";const o=new DataTable(b,{ajax:assetsPath+"json/invoice-list.json",columns:[{data:"id"},{data:"invoice_id"},{data:"invoice_status"},{data:"total"},{data:"issued_date"},{data:"action"}],columnDefs:[{className:"control",orderable:!1,searchable:!1,responsivePriority:2,targets:0,render:function(t,e,a,s){return""}},{targets:1,render:(t,e,a,s)=>{const r=a.invoice_id;return`<a href="${baseUrl}app/invoice/preview"><span>#${r}</span></a>`}},{targets:2,render:(t,e,a,s)=>{const r=a.invoice_status,c=a.due_date,d=a.balance;return`
              <span class='d-inline-block' data-bs-toggle='tooltip' data-bs-html='true'
                    title='<span>${r}<br>
                           <span class="fw-medium">Balance:</span> ${d}<br>
                           <span class="fw-medium">Due Date:</span> ${c}</span>'>
                ${{Sent:'<span class="badge badge-center d-flex align-items-center justify-content-center rounded-pill bg-label-secondary w-px-30 h-px-30"><i class="icon-base ri ri-mail-line icon-16px"></i></span>',Draft:'<span class="badge badge-center d-flex align-items-center justify-content-center rounded-pill bg-label-primary w-px-30 h-px-30"><i class="icon-base ri ri-folder-line icon-16px"></i></span>',"Past Due":'<span class="badge badge-center d-flex align-items-center justify-content-center rounded-pill bg-label-danger w-px-30 h-px-30"><i class="icon-base ri ri-alert-line icon-16px"></i></span>',"Partial Payment":'<span class="badge badge-center d-flex align-items-center justify-content-center rounded-pill bg-label-success w-px-30 h-px-30"><i class="icon-base ri ri-check-line icon-16px"></i></span>',Paid:'<span class="badge badge-center d-flex align-items-center justify-content-center rounded-pill bg-label-warning w-px-30 h-px-30"><i class="icon-base ri ri-pie-chart-line icon-16px"></i></span>',Downloaded:'<span class="badge badge-center d-flex align-items-center justify-content-center rounded-pill bg-label-info w-px-30 h-px-30"><i class="icon-base ri ri-arrow-down-line icon-16px"></i></span>'}[r]}
              </span>
            `}},{targets:3,render:function(t,e,a,s){return"$"+a.total}},{targets:4,render:function(t,e,a,s){var r=new Date(a.issued_date);const c=new Intl.DateTimeFormat("en-GB",{day:"2-digit",month:"short",year:"numeric"}).format(r);var p=`<span class="d-none">${r.toISOString().split("T")[0].replace(/-/g,"")}</span>${c}`;return p}},{targets:4,render:function(t,e,a,s){var r=new Date(a.issued_date),c='<span class="d-none">'+moment(r).format("YYYYMMDD")+"</span>"+moment(r).format("DD MMM YYYY");return c}},{targets:-1,title:"Action",orderable:!1,render:(t,e,a,s)=>`
              <div class="d-flex align-items-center">
                <a href="javascript:;" class="btn btn-icon delete-record"><i class="icon-base ri ri-delete-bin-7-line icon-22px"></i></a>
                <a href="${baseUrl}app/invoice/preview" class="btn btn-icon" data-bs-toggle="tooltip" title="Preview">
                  <i class="icon-base ri ri-eye-line icon-22px"></i>
                </a>
                <div class="d-inline-block">
                  <a href="javascript:;" class="btn btn-icon dropdown-toggle hide-arrow" data-bs-toggle="dropdown">
                    <i class="icon-base ri ri-more-2-line icon-22px"></i>
                  </a>
                  <div class="dropdown-menu dropdown-menu-end m-0">
                    <a href="javascript:;" class="dropdown-item">Download</a>
                    <a href="${baseUrl}app/invoice/edit" class="dropdown-item">Edit</a>
                    <a href="javascript:;" class="dropdown-item">Duplicate</a>
                  </div>
                </div>
              </div>
            `}],order:[[1,"desc"]],displayLength:7,layout:{topStart:{rowClass:"row mx-0 px-3",features:[l]},topEnd:{features:[{buttons:[{extend:"collection",className:"btn btn-primary dropdown-toggle float-sm-end my-5",text:'<i class="icon-base ri ri-upload-2-line icon-16px me-2"></i>Export',buttons:[{extend:"print",text:'<i class="icon-base ri ri-printer-line me-2"></i>Print',className:"dropdown-item",exportOptions:{columns:[1,2,3,4]}},{extend:"csv",text:'<i class="icon-base ri ri-file-text-line me-2"></i>Csv',className:"dropdown-item",exportOptions:{columns:[1,2,3,4]}},{extend:"excel",text:'<i class="icon-base ri ri-file-excel-line me-2"></i>Excel',className:"dropdown-item",exportOptions:{columns:[1,2,3,4]}},{extend:"pdf",text:'<i class="icon-base ri ri-file-pdf-line me-2"></i>Pdf',className:"dropdown-item",exportOptions:{columns:[1,2,3,4]}},{extend:"copy",text:'<i class="icon-base ri ri-file-copy-line me-2"></i>Copy',className:"dropdown-item",exportOptions:{columns:[1,2,3,4]}}]}]}]},bottomStart:{rowClass:"row mx-3 justify-content-between",features:["info"]},bottomEnd:"paging"},language:{paginate:{next:'<i class="icon-base ri ri-arrow-right-s-line scaleX-n1-rtl icon-22px"></i>',previous:'<i class="icon-base ri ri-arrow-left-s-line scaleX-n1-rtl icon-22px"></i>',first:'<i class="icon-base ri ri-skip-back-mini-line scaleX-n1-rtl icon-22px"></i>',last:'<i class="icon-base ri ri-skip-forward-mini-line scaleX-n1-rtl icon-22px"></i>'}},responsive:{details:{display:DataTable.Responsive.display.modal({header:function(t){return"Details of "+t.data().invoice_id}}),type:"column",renderer:function(t,e,a){const s=a.map(function(r){return r.title!==""?`<tr data-dt-row="${r.rowIndex}" data-dt-column="${r.columnIndex}">
                      <td>${r.title}:</td>
                      <td>${r.data}</td>
                    </tr>`:""}).join("");if(s){const r=document.createElement("div");r.classList.add("table-responsive");const c=document.createElement("table");r.appendChild(c),c.classList.add("table");const d=document.createElement("tbody");return d.innerHTML=s,c.appendChild(d),r}return!1}}}});n(),document.addEventListener("show.bs.modal",function(t){t.target.classList.contains("dtr-bs-modal")&&n()}),document.addEventListener("hide.bs.modal",function(t){t.target.classList.contains("dtr-bs-modal")&&n()}),o.on("draw.dt",function(){var t=[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));t.map(function(e){return new bootstrap.Tooltip(e,{boundary:document.body})})})}setTimeout(()=>{[{selector:".dt-length .form-select",classToAdd:"ms-0"},{selector:".dt-length",classToAdd:"mb-md-4 mb-0"},{selector:".dt-buttons",classToAdd:"justify-content-center"},{selector:".dt-layout-table",classToRemove:"row mt-2"},{selector:".dt-layout-full",classToRemove:"col-md col-12",classToAdd:"table-responsive"},{selector:".dt-buttons .btn-group .btn",classToRemove:"btn-secondary"}].forEach(({selector:o,classToRemove:i,classToAdd:n})=>{document.querySelectorAll(o).forEach(t=>{i&&i.split(" ").forEach(e=>t.classList.remove(e)),n&&n.split(" ").forEach(e=>t.classList.add(e))})})},100)});
